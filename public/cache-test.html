<!DOCTYPE html>
<html>
<head>
  <title>Cache Test - v2.0</title>
  <style>
    body { font-family: Arial; padding: 40px; background: #f0f0f0; }
    .box { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
    .success { border-left: 4px solid green; }
    .error { border-left: 4px solid red; }
    button { padding: 10px 20px; margin: 5px; cursor: pointer; font-size: 16px; }
  </style>
</head>
<body>
  <h1>ğŸ” ç¼“å­˜å’Œè¿æ¥æµ‹è¯•</h1>
  
  <div class="box success">
    <h2>âœ… é¡µé¢åŠ è½½æˆåŠŸ</h2>
    <p><strong>æ—¶é—´æˆ³ï¼š</strong> <span id="timestamp"></span></p>
    <p><strong>éšæœºæ•°ï¼š</strong> <span id="random"></span></p>
    <p>å¦‚æœæ—¶é—´æˆ³å’Œéšæœºæ•°æ¯æ¬¡åˆ·æ–°éƒ½å˜åŒ–ï¼Œè¯´æ˜æ²¡æœ‰ç¼“å­˜é—®é¢˜ã€‚</p>
  </div>
  
  <div class="box">
    <h2>ğŸ“Š æµ‹è¯•ç»“æœ</h2>
    <div id="results">
      <p>ç‚¹å‡»ä¸‹é¢æŒ‰é’®å¼€å§‹æµ‹è¯•...</p>
    </div>
  </div>

  <script>
    // æ˜¾ç¤ºæ—¶é—´æˆ³
    document.getElementById('timestamp').textContent = new Date().toLocaleString()
    document.getElementById('random').textContent = Math.random().toFixed(6)
    
    async function testTable(tableName) {
      const url = 'https://qnwtqgdbgyqwpsdqvxfl.supabase.co'
      const key = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFud3RxZ2RiZ3lxd3BzZHF2eGZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5NjM1NDQsImV4cCI6MjA3NTUzOTU0NH0.3sujc8r9taASBUTdXUbCR-oJQcjKgXrLAafYc7k0SU4'
      
      const results = document.getElementById('results')
      results.innerHTML = '<p>â³ æµ‹è¯•ä¸­...</p>'
      
      try {
        const response = await fetch(`${url}/rest/v1/${tableName}?limit=1`, {
          headers: {
            'apikey': key,
            'Authorization': `Bearer ${key}`
          }
        })
        
        if (response.ok) {
          const data = await response.json()
          results.innerHTML = `
            <div class="box success">
              <h3>âœ… ${tableName} è¡¨å­˜åœ¨</h3>
              <p>çŠ¶æ€ï¼š${response.status}</p>
              <p>æ•°æ®ï¼š<pre>${JSON.stringify(data, null, 2)}</pre></p>
            </div>`
        } else {
          const error = await response.text()
          results.innerHTML = `
            <div class="box error">
              <h3>âŒ ${tableName} è¡¨ä¸å­˜åœ¨æˆ–æ— æƒé™</h3>
              <p>çŠ¶æ€ï¼š${response.status}</p>
              <p>é”™è¯¯ï¼š<pre>${error}</pre></p>
            </div>`
        }
      } catch (err) {
        results.innerHTML = `
          <div class="box error">
            <h3>âŒ è¯·æ±‚å¤±è´¥</h3>
            <p><pre>${err.message}</pre></p>
          </div>`
      }
    }
  </script>
  
  <button onclick="testTable('point_history')">æµ‹è¯• point_history</button>
  <button onclick="testTable('ranking_point_history')">æµ‹è¯• ranking_point_history</button>
  <button onclick="testTable('users')">æµ‹è¯• users</button>
</body>
</html>
